# VideoMaker åç«¯æœåŠ¡å¯åŠ¨è¯´æ˜

## ğŸ“‹ é¡¹ç›®æ¦‚è§ˆ

VideoMaker æ˜¯ä¸€ä¸ªåŸºäº FastAPI çš„ç»¼åˆæ€§åç«¯æœåŠ¡ï¼Œæä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š
- ğŸ“„ PDFå¤„ç†å’Œè§£æ
- ğŸ¤ TTSè¯­éŸ³åˆæˆ
- ğŸ¬ è§†é¢‘è½¬ç å’Œå¤„ç†  
- ğŸ–¼ï¸ å›¾ç‰‡å¤„ç†å’Œåˆ†æ
- ğŸ“Š PPTæ–‡æ¡£å¤„ç†
- ğŸ“‹ ä»»åŠ¡ç®¡ç†ç³»ç»Ÿ

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **Webæ¡†æ¶**: FastAPI + Uvicorn
- **AIæœåŠ¡**: OpenAI API
- **è§†é¢‘å¤„ç†**: FFmpeg
- **å›¾åƒå¤„ç†**: OpenCV, PIL
- **æ–‡æ¡£å¤„ç†**: PyMuPDF, python-pptx
- **æ•°æ®åº“**: MySQL, Redis
- **å…¶ä»–**: SQLAlchemy

## ğŸš€ å¿«é€Ÿå¯åŠ¨

æ–¹å¼ï¼šä½¿ç”¨uvicorn
```bash
# è¿›å…¥åç«¯ç›®å½•
cd videomaker/backend

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
venv\Scripts\activate

# ç›´æ¥å¯åŠ¨
uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```

## ğŸ“¦ ç¯å¢ƒå‡†å¤‡

### 1. Pythonç¯å¢ƒ
- Python 3.8+ 
- è™šæ‹Ÿç¯å¢ƒå·²é…ç½®åœ¨ `venv/` ç›®å½•

### 2. æ•°æ®åº“ç¯å¢ƒ
- **MySQL**: å¿…éœ€
  ```bash
  # é…ç½®MySQLæ•°æ®åº“
  cd mysql
  
  # Windows
  setup_database.bat
  
  # Linux/MacOS
  bash setup_database.sh
  
  # æˆ–ä½¿ç”¨Pythonè„šæœ¬
  python setup_database_python.py
  ```

- **Redis**: å¿…éœ€
  ```bash
  # Windows
  # ä¸‹è½½åœ°å€ï¼šhttps://github.com/microsoftarchive/redis/releases
  # å®‰è£…åå¯åŠ¨RedisæœåŠ¡
  
  # Linux
  sudo apt update && sudo apt install redis-server
  sudo systemctl start redis-server
  
  # MacOS
  brew install redis
  brew services start redis
  ```

### 3. ç³»ç»Ÿä¾èµ–
- **FFmpeg**: è§†é¢‘å¤„ç†å¿…éœ€
  ```bash
  # Windows (ä½¿ç”¨scoop)
  scoop install ffmpeg
  
  # macOS
  brew install ffmpeg
  
  # Ubuntu/Debian
  sudo apt update && sudo apt install ffmpeg
  ```

- **Tesseract OCR**: æ–‡å­—è¯†åˆ«åŠŸèƒ½
  ```bash
  # Windows
  ä¸‹è½½å®‰è£…åŒ…: https://github.com/tesseract-ocr/tesseract
  
  # macOS
  brew install tesseract
  
  # Ubuntu/Debian  
  sudo apt install tesseract-ocr
  ```

## ğŸ”§ ä¾èµ–å®‰è£…

```bash
# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
venv\Scripts\activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# éªŒè¯å…³é”®ä¾èµ–
python -c "import fastapi, uvicorn, openai, cv2, ffmpeg, redis, sqlalchemy; print('âœ… ä¾èµ–æ£€æŸ¥é€šè¿‡')"
```

## ğŸŒ æœåŠ¡è®¿é—®

å¯åŠ¨æˆåŠŸåï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®ï¼š

- **APIæœåŠ¡**: http://localhost:8000
- **APIæ–‡æ¡£**: http://localhost:8000/docs
- **ReDocæ–‡æ¡£**: http://localhost:8000/redoc
- **å¥åº·æ£€æŸ¥**: http://localhost:8000

## ğŸ“š APIæ¨¡å—

### æ ¸å¿ƒåŠŸèƒ½æ¨¡å—
- `/api/pdf` - PDFå¤„ç†ç›¸å…³æ¥å£
- `/api/tts` - è¯­éŸ³åˆæˆç›¸å…³æ¥å£  
- `/api/videos` - è§†é¢‘å¤„ç†å’Œè½¬ç æ¥å£
- `/api/notes` - ç¬”è®°å’Œæ–‡æ¡£å¤„ç†æ¥å£
- `/api/images` - å›¾ç‰‡å¤„ç†æ¥å£
- `/api/tasks` - ä»»åŠ¡ç®¡ç†æ¥å£
- `/api/downloads` - æ–‡ä»¶ä¸‹è½½æ¥å£

### ğŸ¬ è§†é¢‘åˆ¶ä½œå·¥ä½œæµç¨‹

APIæ–‡æ¡£å·²ç»„ç»‡ä¸ºå®Œæ•´çš„å·¥ä½œæµç¨‹ï¼ŒæŒ‰ä»¥ä¸‹æ­¥éª¤è°ƒç”¨å³å¯å®ŒæˆPPTåˆ°è§†é¢‘çš„è½¬æ¢ï¼š

1. **ä¸Šä¼ PPTå¹¶è½¬æ¢ä¸ºPDF** - `/api/pdf/upload-ppt-convert-pdf`
2. **PDFè½¬æ¢ä¸ºå›¾ç‰‡** - `/api/pdf/convert/{task_id}`
3. **ä¸ºå›¾ç‰‡æ·»åŠ é»‘è‰²è¾¹æ¡†** - `/api/image-notes/add-black-border` 
4. **ç”Ÿæˆæ–‡ä»¶å¤¹è„šæœ¬** - `/api/notes/generate-folder-scripts`
5. **ç”Ÿæˆæ‰€æœ‰éŸ³é¢‘** - `/api/tts/generate`

æ¯ä¸ªAPIéƒ½åœ¨æ–‡æ¡£ä¸­æœ‰è¯¦ç»†è¯´æ˜ï¼ŒåŒ…æ‹¬è¾“å…¥å‚æ•°ã€å¤„ç†æµç¨‹å’Œè¿”å›ç»“æœã€‚
å„ä¸ªæ­¥éª¤ä¹‹é—´é€šè¿‡task_idå…³è”ï¼Œç¡®ä¿å·¥ä½œæµçš„è¿è´¯æ€§ã€‚

## ğŸ—‚ï¸ ç›®å½•ç»“æ„

```
videomaker/backend/
â”œâ”€â”€ app/                    # åº”ç”¨ä¸»ç›®å½•
â”‚   â”œâ”€â”€ api/               # APIè·¯ç”±æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ pdf_api.py     # PDFå¤„ç†æ¥å£
â”‚   â”‚   â”œâ”€â”€ video_api.py   # è§†é¢‘å¤„ç†æ¥å£
â”‚   â”‚   â”œâ”€â”€ tts_api.py     # TTSæ¥å£
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ utils/             # å·¥å…·æ¨¡å—
â”‚       â”œâ”€â”€ transcoding.py # è§†é¢‘è½¬ç å·¥å…·
â”‚       â”œâ”€â”€ task_manager_memory.py # ä»»åŠ¡ç®¡ç†
â”‚       â”œâ”€â”€ mysql_config_helper.py # MySQLé…ç½®
â”‚       â””â”€â”€ ...
â”œâ”€â”€ mysql/                 # MySQLæ•°æ®åº“é…ç½®
â”‚   â”œâ”€â”€ create_database.sql # åˆ›å»ºæ•°æ®åº“è„šæœ¬
â”‚   â”œâ”€â”€ init.sql           # æ•°æ®åˆå§‹åŒ–è„šæœ¬
â”‚   â”œâ”€â”€ setup_database.bat # Windowsæ•°æ®åº“é…ç½®
â”‚   â”œâ”€â”€ setup_database.sh  # Linuxæ•°æ®åº“é…ç½®
â”‚   â””â”€â”€ setup_database_python.py # Pythonæ•°æ®åº“é…ç½®
â”œâ”€â”€ main.py                # FastAPIåº”ç”¨ä¸»æ–‡ä»¶
â”œâ”€â”€ start_server.py        # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ requirements.txt       # Pythonä¾èµ–
â”œâ”€â”€ docker-compose.yml     # Dockeré…ç½®
â”œâ”€â”€ uploads/               # ä¸Šä¼ æ–‡ä»¶ç›®å½•
â”œâ”€â”€ videos/                # è§†é¢‘æ–‡ä»¶ç›®å½•
â”œâ”€â”€ encoded_videos/        # è½¬ç è¾“å‡ºç›®å½•
â”œâ”€â”€ notes_output/          # ç¬”è®°è¾“å‡ºç›®å½•
â””â”€â”€ ...
```

## ğŸ“‹ å¯åŠ¨æ£€æŸ¥æ¸…å•

å¯åŠ¨å‰è¯·ç¡®è®¤ï¼š

- [ ] Python 3.10+ å·²å®‰è£…
- [ ] è™šæ‹Ÿç¯å¢ƒå·²æ¿€æ´»
- [ ] MySQLæœåŠ¡å·²å¯åŠ¨ä¸”æ•°æ®åº“å·²åˆ›å»º
- [ ] RedisæœåŠ¡å·²å¯åŠ¨
- [ ] FFmpeg å·²å®‰è£…å¹¶åœ¨PATHä¸­
- [ ] æ‰€æœ‰ä¾èµ–å·²å®‰è£… (`pip install -r requirements.txt`)
- [ ] ç«¯å£8000æœªè¢«å ç”¨
- [ ] ç›¸å…³ç›®å½•æœ‰è¯»å†™æƒé™

## ğŸ” å¸¸è§é—®é¢˜

### 1. FFmpegæœªæ‰¾åˆ°
```bash
# æ£€æŸ¥FFmpegæ˜¯å¦å®‰è£…
ffmpeg -version

# å¦‚æœæœªå®‰è£…ï¼Œå‚è€ƒä¸Šé¢çš„å®‰è£…è¯´æ˜
```

### 2. ç«¯å£è¢«å ç”¨
```bash
# æŸ¥çœ‹å ç”¨ç«¯å£çš„è¿›ç¨‹
netstat -ano | findstr :8000

# æ€æ­»å ç”¨è¿›ç¨‹ï¼ˆWindowsï¼‰
taskkill /PID <è¿›ç¨‹ID> /F

# æˆ–è€…ä¿®æ”¹ç«¯å£
uvicorn main:app --port 8001
```

### 3. ä¾èµ–å®‰è£…å¤±è´¥
```bash
# æ›´æ–°pip
python -m pip install --upgrade pip

# æ¸…ç†ç¼“å­˜é‡æ–°å®‰è£…
pip cache purge
pip install -r requirements.txt --no-cache-dir
```

### 4. OpenAI APIé…ç½®
ç¡®ä¿ `.env` æ–‡ä»¶ä¸­çš„ `OPENAI_API_KEY` é…ç½®æ­£ç¡®ã€‚

### 5. MySQLè¿æ¥é—®é¢˜
```bash
# æ£€æŸ¥MySQLæœåŠ¡æ˜¯å¦è¿è¡Œ
# Windows
sc query mysql

# Linux
systemctl status mysql

# éªŒè¯æ•°æ®åº“æ˜¯å¦åˆ›å»º
mysql -u root -p -e "SHOW DATABASES;"
```

### 6. Redisè¿æ¥é—®é¢˜
```bash
# æ£€æŸ¥RedisæœåŠ¡çŠ¶æ€
# Windows
sc query redis

# Linux
systemctl status redis-server

# æµ‹è¯•Redisè¿æ¥
redis-cli ping
```

## ğŸ“Š æœåŠ¡ç›‘æ§

### æ—¥å¿—æŸ¥çœ‹
- æ§åˆ¶å°æ—¥å¿—ï¼šå®æ—¶æ˜¾ç¤ºåœ¨ç»ˆç«¯
- è½¬ç æ—¥å¿—ï¼šæŸ¥çœ‹ `transcoding.log` æ–‡ä»¶

### å¥åº·æ£€æŸ¥
```bash
# APIå¥åº·æ£€æŸ¥
curl http://localhost:8000

# å…·ä½“åŠŸèƒ½æµ‹è¯•
curl http://localhost:8000/api/videos/all-folders
```

## ğŸ”§ å¼€å‘æ¨¡å¼

```bash
# å¼€å¯çƒ­é‡è½½æ¨¡å¼
uvicorn main:app --reload --host 0.0.0.0 --port 8000

# å¼€å¯è°ƒè¯•æ¨¡å¼
uvicorn main:app --reload --log-level debug
```

## ğŸ›‘ åœæ­¢æœåŠ¡

- **å¿«æ·é”®**: Ctrl + C
- **Docker**: `docker stop <container_id>`

---

**ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ**
- æŸ¥çœ‹APIæ–‡æ¡£: http://localhost:8000/docs
- æ£€æŸ¥æ—¥å¿—è¾“å‡ºè·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯
- ç¡®è®¤æ‰€æœ‰ä¾èµ–å’Œç¯å¢ƒé…ç½®æ­£ç¡®

---
*æœ€åæ›´æ–°: 2024å¹´3æœˆ15æ—¥* 